import pandas as pd

# Load the projected fantasy points for 2023
projected_data = pd.read_csv(r"C:\Users\asimw\Downloads\Projected_Fantasy_Points_2023.csv")

# Actual fantasy points for running backs (RBs)
actual_fantasy_points_rb = {
    "Christian McCaffrey": 391.3,
    "Breece Hall": 290.5,
    "Travis Etienne Jr.": 282.4,
    "Rachaad White": 267.9,
    "Raheem Mostert": 267.7,
    "Joe Mixon": 267.0,
    "Kyren Williams": 255.0,
    "Derrick Henry": 246.66,
    "Bijan Robinson": 246.3,
    "Jahmyr Gibbs": 242.1,
    "Alvin Kamara": 233.0,
    "James Cook": 232.7,
    "Saquon Barkley": 223.2,
    "Tony Pollard": 222.6,
    "Isiah Pacheco": 213.9,
    "Jerome Ford": 211.2,
    "David Montgomery": 207.2,
    "James Conner": 201.5,
    "Kenneth Walker III": 199.4,
    "D'Andre Swift": 199.3,
    "Brian Robinson Jr.": 198.1,
    "Jaylen Warren": 196.4,
    "Najee Harris": 195.5,
    "De'Von Achane": 190.7,
    "Gus Edwards": 187.0,
    "Austin Ekeler": 185.4,
    "Chuba Hubbard": 182.5,
    "Josh Jacobs": 181.1,
    "Javonte Williams": 179.2,
    "Ezekiel Elliott": 174.5,
    "Zack Moss": 169.6,
    "Devin Singletary": 167.34,
    "Jonathan Taylor": 156.4,
    "Tyjae Spears": 153.8,
    "Rhamondre Stevenson": 145.7,
    "Tyler Allgeier": 137.6,
    "Aaron Jones": 134.9,
    "Alexander Mattison": 133.2,
    "Antonio Gibson": 127.4,
    "Samaje Perine": 121.3,
    "Kareem Hunt": 118.5,
    "AJ Dillon": 117.6,
    "Khalil Herbert": 112.5,
    "Justice Hill": 109.3,
    "Zach Charbonnet": 106.1,
    "Jaleel McLaughlin": 106.0,
    "Roschon Johnson": 102.1,
    "Ty Chandler": 101.0,
    "Kenneth Gainwell": 97.38,
    "Rico Dowdle": 91.5,
    "D'Onta Foreman": 91.2,
    "Miles Sanders": 87.6,
    "Jerick McKinnon": 84.36,
    "Latavius Murray": 82.9,
    "Dameon Pierce": 76.7,
    "Zamir White": 73.9,
    "Emari Demercado": 73.3,
    "Clyde Edwards-Helaire": 70.1,
    "Keaton Mitchell": 69.9,
    "Joshua Kelley": 61.7,
    "Jamaal Williams": 60.8,
    "Michael Carter": 58.8,
    "Chase Brown": 53.5,
    "Elijah Mitchell": 47.5,
    "Matt Breida": 46.9,
    "Cam Akers": 46.7,
    "Royce Freeman": 46.2,
    "Jordan Mason": 44.7,
    "Darrell Henderson Jr.": 43.5,
    "Kendre Miller": 43.3,
    "Salvon Ahmed": 42.9,
    "Pierre Strong Jr.": 42.8,
    "Jeff Wilson Jr.": 41.3,
    "Ameer Abdullah": 41.0,
    "Dalvin Cook": 40.2,
    "Chase Edmonds": 39.7,
    "Kyle Juszczyk": 38.5,
    "Chris Rodriguez Jr.": 37.9,
    "Cordarrelle Patterson": 36.9,
    "D'Ernest Johnson": 34.8,
    "Andrew Beck": 32.8,
    "Ty Johnson": 32.4,
    "Tony Jones": 32.2,
    "Darrynton Evans": 30.0,
    "Patrick Taylor Jr.": 30.0,
    "Craig Reynolds": 29.6,
    "Alec Ingold": 24.9,
    "Nick Chubb": 23.1,
    "Tank Bigsby": 22.8,
    "Kevin Harris": 21.3,
    "Trey Sermon": 20.3,
    "Ronnie Rivers": 20.1,
    "Melvin Gordon III": 19.7,
    "Damien Harris": 19.0,
    "Isaiah Spiller": 19.0,
    "Tyler Goodson": 18.1,
    "Raheem Blackshear": 17.1,
    "Israel Abanikanda": 16.3,
    "Patrick Ricard": 16.2,
    "Boston Scott": 15.8,
    "Deuce Vaughn": 15.0,
    "Trayveon Williams": 14.9,
    "Emanuel Wilson": 14.8,
    "La'Mical Perine": 14.0,
    "Keaontay Ingram": 14.0,
    "Mike Boone": 13.3,
    "Eric Gray": 13.0,
    "Hunter Luepke": 12.7,
    "J.K. Dobbins": 11.7,
    "Gary Brightwell": 11.6,
    "Nick Bawden": 11.5,
    "Brandon Bolden": 11.1,
    "Chris Brooks": 10.6,
    "Dare Ogunbowale": 10.3,
    "DeeJay Dallas": 10.2,
    "C.J. Ham": 10.2,
    "Damien Williams": 7.5,
    "Michael Burton": 6.7,
    "Ke'Shawn Vaughn": 6.4,
    "Keith Smith": 5.8,
    "Khari Blasingame": 5.2,
    "Sean Tucker": 4.8,
    "Rashaad Penny": 4.3,
    "Alex Armah": 4.3,
    "Jashaun Corbin": 4.0,
    "Leonard Fournette": 4.0,
    "Deon Jackson": 3.9,
    "Elijah Dotson": 3.2,
    "Jake Funk": 3.1,
    "Zonovan Knight": 3.1,
    "Anthony McFarland Jr.": 3.1,
    "Kenyan Drake": 2.6,
    "Derrick Gore": 2.4,
    "Adam Prentice": 2.3,
    "Devine Ozigbo": 2.1,
    "Jakob Johnson": 2.1,
    "Tyrion Davis-Price": 1.9,
    "Chris Evans": 1.9,
    "Zach Evans": 1.3,
    "Tucker Fisk": 1.3,
    "Evan Hull": 1.2,
    "Kene Nwangwu": 1.1,
    "Reggie Gilliam": 1.0,
    "Giovanni Ricci": 0.0,
    "Jonathan Ward": 0.0,
    "James Robinson": 0.0,
    "Jason Cabinda": 0.0,
    "Godwin Igwebuike": 0.0,
    "Travis Homer": 0.0,
    "Myles Gaskin": 0.0,
    "Julius Chestnut": 0.0,
    "Taiwan Jones": 0.0,
    "Dwayne Washington": 0.0,
    "Qadree Ollison": 0.0,
    "Corey Clement": 0.0,
    "Jordan Mims": 0.0,
    "Malik Davis": 0.0,
    "Mohamed Ibrahim": 0.0,
    "SaRodorick Thompson Jr.": 0.0,
    "Owen Wright": 0.0,
    "Kenny McIntosh": 0.0
}

# Actual fantasy points for wide receivers (WRs)
actual_fantasy_points_wr = {
    "Michael Pittman Jr.": 250.2, "Brandon Aiyuk": 249.2, "Deebo Samuel Sr.": 243.7, "Chris Olave": 231.3,
    "Adam Thielen": 231, "Calvin Ridley": 229.9, "DeVonta Smith": 227.6, "Amari Cooper": 227, "DK Metcalf": 225.4,
    "DeAndre Hopkins": 223.6, "Jordan Addison": 221.3, "Jakobi Meyers": 218.58, "Jayden Reed": 217.2, "Garrett Wilson": 213.2,
    "Rashee Rice": 212.5, "Terry McLaurin": 209.2, "Chris Godwin": 209.2, "George Pickens": 208.8, "Zay Flowers": 206.4,
    "Tyler Lockett": 202.4, "Justin Jefferson": 202.2, "Jaylen Waddle": 198.6, "Courtland Sutton": 190.2, "Romeo Doubs": 174.4,
    "Drake London": 174.38, "Brandin Cooks": 173.2, "Tank Dell": 165, "Cooper Kupp": 164.4, "Gabe Davis": 161.4,
    "Curtis Samuel": 157.2, "Josh Downs": 157.1, "Diontae Johnson": 152.7, "Darius Slayton": 151, "Christian Kirk": 150.26,
    "Jaxon Smith-Njigba": 149.8, "Rashid Shaheed": 149.6, "Tyler Boyd": 144.8, "Jerry Jeudy": 141.8, "Tee Higgins": 137.6,
    "Marquise Brown": 134.7, "Wan'Dale Robinson": 133.2, "Elijah Moore": 132.1, "Josh Reynolds": 128.8, "Jahan Dotson": 124.8,
    "K.J. Osborn": 120, "Dontayvion Wicks": 119.76, "DJ Chark": 115.5, "Michael Wilson": 114.5, "Khalil Shakir": 113.1,
    "Tutu Atwell": 112.4, "Odell Beckham Jr.": 107.5, "Demario Douglas": 107.2, "Joshua Palmer": 106.7, "Rondale Moore": 105,
    "Noah Brown": 101.6, "Christian Watson": 100, "Kendrick Bourne": 97.4, "Kalif Raymond": 97.1, "Nelson Agholor": 95.7,
    "Trey Palmer": 95.4, "Alec Pierce": 94, "Quentin Johnston": 89.8, "Michael Thomas": 89.3, "Robert Woods": 89,
    "Justin Watson": 87.8, "Michael Gallup": 87.4, "Demarcus Robinson": 84.8, "Nick Westbrook-Ikhine": 80.3,
    "Jonathan Mingo": 78.9, "Jameson Williams": 78.1, "Darnell Mooney": 76.5, "Zay Jones": 73.4, "Rashod Bateman": 72.4,
    "Brandon Johnson": 71.8, "DeVante Parker": 69.6, "Tre Tucker": 68.3, "Cedrick Wilson Jr.": 67.1, "Chris Moore": 64.7,
    "Brandon Powell": 64.5, "Marvin Mims Jr.": 62.6, "Greg Dortch": 62, "Trenton Irwin": 61, "Allen Robinson II": 60.6,
    "JuJu Smith-Schuster": 60.3, "A.T. Perry": 60.1, "Jalin Hyatt": 60, "Allen Lazard": 59.7, "Isaiah Hodgins": 58.8,
    "KaVontae Turpin": 57.9, "Jalen Tolbert": 56.9, "Braxton Berrios": 56.5, "Jake Bobo": 53.7, "Marquez Valdes-Scantling": 53,
    "Skyy Moore": 52.7, "Kadarius Toney": 52.7, "Calvin Austin III": 51.5, "Xavier Gipson": 50.6, "Jauan Jennings": 50.2,
    "Andrei Iosivas": 48.7, "Mike Williams": 47.2, "David Bell": 45.9, "Hunter Renfrow": 45.2, "Lil'Jordan Humphrey": 44.2,
    "Bo Melton": 43.1, "Alex Erickson": 41.3, "Cedric Tillman": 40.3, "Mack Hollins": 39.9, "Van Jefferson": 39.2,
    "Jamal Agnew": 39.1, "Treylon Burks": 38.4, "Parker Washington": 37.2, "Scotty Miller": 36.4, "Olamide Zaccheaus": 35.9,
    "KhaDarel Hodge": 35.9, "Julio Jones": 35.2, "Jamison Crowder": 34.96, "Tyler Scott": 34.9, "Quez Watkins": 34,
    "Dyami Brown": 33.5, "Deven Thompkins": 32.9, "Deonte Harty": 32.2, "Malik Heath": 31.1, "Terrace Marshall Jr.": 30.8,
    "John Metchie III": 30.4, "Kyle Philips": 29.7, "Ronnie Bell": 28.5, "Parris Campbell": 28.1, "Derius Davis": 27.2,
    "Ray-Ray McCloud": 27.1, "Donovan Peoples-Jones": 26.5, "Byron Pringle": 25.7, "Tyquan Thornton": 25.6, "River Cracraft": 24.9,
    "Ihmir Smith-Marsette": 22.6, "Mecole Hardman Jr.": 22.5, "Trent Sherfield Sr.": 22.5, "Jalen Guyton": 21.9, "Robbie Chosen": 21.7,
    "Jalen Reagor": 21.5, "Lynn Bowden Jr.": 21.5, "Xavier Hutchinson": 20.6, "Chase Claypool": 20.4, "Ben Skowronek": 20.3,
    "Laviska Shenault Jr.": 19.4, "Isaiah McKenzie": 19.3, "David Moore": 17.8, "Sterling Shepard": 16.9, "Richie James": 16.6,
    "Tim Jones": 16.4, "Samori Toure": 16.2, "Randall Cobb": 14.7, "Jason Brownlee": 14.7, "Keith Kirkwood": 14.6,
    "Charlie Jones": 14.6, "D.J. Montgomery": 14, "Marquise Goodwin": 13.6, "Jalen Brooks": 12.9, "Justyn Ross": 12.8,
    "Equanimeous St. Brown": 12.1, "Velus Jones Jr.": 11.6, "Rakim Jarrett": 11.2, "Chris Conley": 11.1, "Ty Montgomery II": 10.8,
    "DeAndre Carter": 10.6, "Keelan Doss": 10.3, "Tyler Johnson": 10, "Britain Covey": 9.9, "Simi Fehoko": 9.9,
    "Devin Duvernay": 9.7, "Elijah Cooks": 9.3, "Marvin Jones Jr.": 8.8, "Jalen Nailor": 8.8, "Zach Pascal": 8.2
}

# Actual fantasy points for tight ends (TEs)
actual_fantasy_points_te = {
    "Sam LaPorta": 239.3, "Evan Engram": 230.3, "Travis Kelce": 219.4, "T.J. Hockenson": 219, "George Kittle": 203.2,
    "David Njoku": 201.2, "Trey McBride": 181.5, "Cole Kmet": 181.1, "Jake Ferguson": 177.1, "Dalton Schultz": 150.5,
    "Dalton Kincaid": 150.3, "Kyle Pitts": 137.3, "Dallas Goedert": 136.3, "Mark Andrews": 132.5, "Hunter Henry": 132.3,
    "Luke Musgrave": 120.1, "Pat Freiermuth": 113.2, "Logan Thomas": 109.3, "Jonnu Smith": 106.5, "Darren Waller": 104.6,
    "Donald Parham Jr.": 103.1, "Gerald Everett": 102.4, "Chigoziem Okonkwo": 96.4, "Tyler Higbee": 93.8, "Juwan Johnson": 90.5,
    "Cade Otton": 89.7, "Zach Ertz": 88.3, "Noah Fant": 87.6, "Michael Mayer": 85.4, "Tyler Conklin": 85, "Cole Turner": 81.6,
    "Isaiah Likely": 79.4, "Kylen Granson": 78.3, "Taysom Hill": 77.3, "Durham Smythe": 76.2, "Josh Oliver": 75.1,
    "Adam Trautman": 74.3, "Harrison Bryant": 74.1, "Kylan Granson": 73.5, "Robert Tonyan": 70.8, "Austin Hooper": 69.6,
    "Jordan Akins": 68.7, "C.J. Uzomah": 67.5, "Dawson Knox": 65.8, "Jelani Woods": 63.1, "Hunter Long": 62.4, "Irv Smith Jr.": 60.2,
    "Pharaoh Brown": 58.7, "John Bates": 58.3, "Foster Moreau": 56.2, "Brock Wright": 55.7, "Andrew Beck": 54.6,
    "Darnell Washington": 54.1, "Mo Alie-Cox": 53.3, "Cameron Brate": 52.4, "Josh Whyle": 52, "Charlie Kolar": 51.2,
    "James Mitchell": 49.8, "Luke Schoonmaker": 48.7, "Peyton Hendershot": 48.4, "Albert Okwuegbunam": 47.3, "Tommy Tremble": 45.2,
    "Teagan Quitoriano": 44.3, "MyCole Pruitt": 43.1, "Tre' McKitty": 42.8, "Tyler Kroft": 42.3, "Brevin Jordan": 40.9,
    "Jesper Horsted": 39.2, "Jared Pinkney": 38.6, "Eric Saubert": 38.1, "Stephen Anderson": 36.7, "Chris Manhertz": 35.8,
    "Dan Arnold": 34.6, "Shane Zylstra": 34.2, "Jake Ferguson": 32.4, "Ian Thomas": 31.8, "Marcedes Lewis": 30.5,
    "Nick Vannett": 29.7, "Richard Rodgers": 29.2, "Eric Tomlinson": 28.5, "Ryan Griffin": 27.3, "Tyree Jackson": 26.9,
    "Deon Yelder": 25.6, "Ben Ellefson": 25.2, "J.P. Holtz": 24.8, "Parker Hesse": 24.3, "Tyler Davis": 23.6, "Kaden Smith": 23.2,
    "Blake Bell": 22.7, "Antony Auclair": 22.4, "Darrell Daniels": 21.9, "Lee Smith": 21.4, "David Wells": 21, "Adam Shaheen": 20.7,
    "Jace Sternberger": 20.3, "Troy Fumagalli": 20.1, "Matt Sokol": 19.9, "Andrew Vollert": 19.5, "Stephen Sullivan": 19.2,
    "Cheyenne O'Grady": 18.9, "Drew Sample": 18.7, "Cole Hikutini": 18.4, "Cethan Carter": 18.1, "Matt Bushman": 17.8,
    "Ethan Wolf": 17.5, "Dillon Radunz": 17.2, "Ryan Izzo": 16.9, "Eli Wolf": 16.6, "Sean Culkin": 16.3, "Thaddeus Moss": 16,
    "Jerell Adams": 15.8, "Giovanni Ricci": 15.5, "Charlie Woerner": 15.3, "Johnny Mundt": 15, "Nakia Griffin-Stewart": 14.8,
    "Kahale Warring": 14.5, "David Grinnage": 14.3, "Jacob Hollister": 14.1, "Alize Mack": 13.9, "Kyle Markway": 13.6,
    "Jordan Franks": 13.3, "Alton Robinson": 13.1, "Brandon Dillon": 12.8, "Ryan Becker": 12.6, "Keenen Brown": 12.4,
    "Jared Rice": 12.1, "Elijah Wellman": 11.8, "Daniel Helm": 11.6, "Nate Becker": 11.4, "Gabe Nabers": 11.1,
    "Andrew Beck": 10.9, "Zach Davidson": 10.7, "Matt Lengel": 10.4, "Mason Schreck": 10.2, "Nick Bowers": 10, "Rysen John": 9.8,
    "Jordan Leggett": 9.6, "John Lovett": 9.4, "Kenny Yeboah": 9.2, "Cary Angeline": 9, "Geoff Swaim": 8.8, "Daniel Brown": 8.6,
    "Chris Myarick": 8.4, "Dax Raymond": 8.2, "Darion Clark": 8, "Brandon Barnes": 7.8, "Nick Guggemos": 7.6,
    "Samizadeh Oglesby": 7.4, "Woody Brandom": 7.2, "Tyrone Swoopes": 7, "Kip Smith": 6.8, "Kendall Blanton": 6.6,
    "Deon Sizer": 6.4, "Charlie Taumoepeau": 6.2, "Tyler Mabry": 6, "Bug Howard": 5.8, "Matt Seybert": 5.6,
    "Nakia Griffin-Stewart": 5.4, "Nikolas Grigsby": 5.2, "John Phillips": 5, "Blake Mack": 4.8, "Jeremiah Hall": 4.6,
    "Ben Braunecker": 4.4, "Miller Forristall": 4.2, "Connor Davis": 4, "Matt Weiser": 3.8, "Niles Paul": 3.6,
    "Jordan Thomas": 3.4, "Gavin Escobar": 3.2, "David Thomas": 3, "Brian Parker": 2.8, "Jason Vander Laan": 2.6,
    "Logan Paulsen": 2.4, "Cole Wick": 2.2, "Jordan Simmons": 2, "Kendrick Rogers": 1.8, "Ian Bunting": 1.6,
    "Austin Fort": 1.4, "David Njoku": 1.2, "Elijah Nkansah": 1, "Demetrius Harris": 0.8, "J.P. Holtz": 0.6,
    "Garrett Griffin": 0.4, "Ethan Wolf": 0.2, "Antony Auclair": 0
}

# Combine all the actual fantasy points into one dictionary
actual_fantasy_points = {**actual_fantasy_points_rb, **actual_fantasy_points_wr, **actual_fantasy_points_te}

# Initialize a list to store percentage differences
percentage_differences = []

# Iterate through the projected data and compare with actual data
for index, row in projected_data.iterrows():
    player_name = row['Player']
    projected_points = row['Predicted Fantasy Points']
    
    if player_name in actual_fantasy_points:
        actual_points = actual_fantasy_points[player_name]
        percentage_difference = abs((actual_points - projected_points) / projected_points) * 100
        percentage_differences.append({
            'Player': player_name,
            'Projected_Fantasy_Points': projected_points,
            'Actual_Fantasy_Points': actual_points,
            'Percentage_Difference': percentage_difference
        })

# Convert the results into a DataFrame
results_df = pd.DataFrame(percentage_differences)

# Merge the results with the original projected_data DataFrame
merged_df = projected_data.merge(results_df, on='Player', how='left')

# Save the merged DataFrame to a new CSV file
merged_df.to_csv(r"C:\Users\asimw\Downloads\Projected_vs_Actual_Fantasy_Points_2023.csv", index=False)

# Display the merged DataFrame
print(merged_df)
